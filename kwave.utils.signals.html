<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="kwave.utils.tictoc module" href="kwave.utils.tictoc.html" /><link rel="prev" title="kwave.utils.pml module" href="kwave.utils.pml.html" />

    <!-- Generated with Sphinx 5.3.0 and Furo 2022.12.07 -->
        <title>kwave.utils.signals module - k-wave-python documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=91d0f0d1c444bdcb17a68e833c7a53903343c195" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-toolbox-code.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">k-wave-python  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">k-wave-python  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="get_started/contrib.html">Contribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="get_started/license.html">License</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="development/development_environment.html">Development Environment</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">kwave</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="kwave.data.html">kwave.data module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.enums.html">kwave.enums module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.executor.html">kwave.executor module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.kWaveSimulation.html">kwave.kWaveSimulation module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.kgrid.html">kwave.kgrid module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.kmedium.html">kwave.kmedium module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.ksensor.html">kwave.ksensor module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.ksource.html">kwave.ksource module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.kspaceFirstOrder.html">kwave.kspaceFirstOrder module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.kspaceFirstOrder2D.html">kwave.kspaceFirstOrder2D module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.kspaceFirstOrder3D.html">kwave.kspaceFirstOrder3D module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.kspaceFirstOrderAS.html">kwave.kspaceFirstOrderAS module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.ktransducer.html">kwave.ktransducer module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.options.html">kwave.options module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.recorder.html">kwave.recorder module</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="kwave.utils.html">kwave.utils package</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.checks.html">kwave.utils.checks module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.colormap.html">kwave.utils.colormap module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.conversion.html">kwave.utils.conversion module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.data.html">kwave.utils.data module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.dotdictionary.html">kwave.utils.dotdictionary module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.filters.html">kwave.utils.filters module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.interp.html">kwave.utils.interp module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.io.html">kwave.utils.io module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.mapgen.html">kwave.utils.mapgen module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.math.html">kwave.utils.math module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.matrix.html">kwave.utils.matrix module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.pml.html">kwave.utils.pml module</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">kwave.utils.signals module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.tictoc.html">kwave.utils.tictoc module</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="kwave.kWaveSimulation_helper.html">kwave.kWaveSimulation_helper package</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.create_absorption_variables.html">kwave.kWaveSimulation_helper.create_absorption_variables module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.create_storage_variables.html">kwave.kWaveSimulation_helper.create_storage_variables module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.data_cast.html">kwave.kWaveSimulation_helper.data_cast module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.display_simulation_params.html">kwave.kWaveSimulation_helper.display_simulation_params module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.expand_grid_matrices.html">kwave.kWaveSimulation_helper.expand_grid_matrices module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.retract_transducer_grid_size.html">kwave.kWaveSimulation_helper.retract_transducer_grid_size module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.save_to_disk_func.html">kwave.kWaveSimulation_helper.save_to_disk_func module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.scale_source_terms_func.html">kwave.kWaveSimulation_helper.scale_source_terms_func module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.set_sound_speed_ref.html">kwave.kWaveSimulation_helper.set_sound_speed_ref module</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="kwave.reconstruction.html">kwave.reconstruction package</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="kwave.reconstruction.beamform.html">kwave.reconstruction.beamform module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.reconstruction.converter.html">kwave.reconstruction.converter module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.reconstruction.shifted_transform.html">kwave.reconstruction.shifted_transform module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.reconstruction.tools.html">kwave.reconstruction.tools module</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="edit-this-page">
  <a class="muted-link" href="https://github.com/waltsims/k-wave-python/edit/master/docs/kwave.utils.signals.rst" title="Edit this page">
    <svg aria-hidden="true" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" />
      <line x1="13.5" y1="6.5" x2="17.5" y2="10.5" />
    </svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="module-kwave.utils.signals">
<span id="kwave-utils-signals-module"></span><h1>kwave.utils.signals module<a class="headerlink" href="#module-kwave.utils.signals" title="Permalink to this heading">#</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.signals.add_noise">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.signals.</span></span><span class="sig-name descname"><span class="pre">add_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rms'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/signals.html#add_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.signals.add_noise" title="Permalink to this definition">#</a></dt>
<dd><p>Add Gaussian noise to a signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<em>np.array</em>) – input signal</p></li>
<li><p><strong>snr</strong> (<em>float</em>) – desired signal snr (signal-to-noise ratio) in decibels after adding noise</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – ‘rms’ (default) or ‘peak’</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>signal with augmented with noise. This behaviour differs from the k-Wave MATLAB implementation in that the SNR is nor returned.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>signal (np.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.signals.calc_max_freq">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.signals.</span></span><span class="sig-name descname"><span class="pre">calc_max_freq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_spat_freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/signals.html#calc_max_freq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.signals.calc_max_freq" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.signals.create_cw_signals">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.signals.</span></span><span class="sig-name descname"><span class="pre">create_cw_signals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ramp_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/signals.html#create_cw_signals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.signals.create_cw_signals" title="Permalink to this definition">#</a></dt>
<dd><p>create_cw_signals generates a series of continuous wave (CW) signals
based on the 1D or 2D input matrices amp and phase, where each signal
is given by:</p>
<blockquote>
<div><p>amp(i, j) .* sin(2 .* pi .* freq .* t_array + phase(i, j));</p>
</div></blockquote>
<p>To avoid startup transients, a cosine tapered up-ramp is applied to
the beginning of the signal. By default, the length of this ramp is
four periods of the wave. The up-ramp can be turned off by setting
the ramp_length to 0.</p>
<blockquote>
<div><p>Example:</p>
<blockquote>
<div><p># define sampling parameters
f = 5e6
T = 1/f
Fs = 100e6
dt = 1/Fs
t_array = np.arange(0, 10*T, dt)</p>
<p># define amplitude and phase
amp = get_win(9, ‘Gaussian’)
phase = np.arange(0, 2*pi, 9).T</p>
<p># create signals and plot
cw_signal = create_cw_signals(t_array, f, amp, phase)</p>
</div></blockquote>
<dl class="simple">
<dt>Args:</dt><dd><p>t_array:
freq:
amp:
phase:
ramp_length:</p>
</dd>
<dt>Returns:</dt><dd><p>cw_signals:</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.signals.get_alpha_filter">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.signals.</span></span><span class="sig-name descname"><span class="pre">get_alpha_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kgrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">medium</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">taper_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/signals.html#get_alpha_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.signals.get_alpha_filter" title="Permalink to this definition">#</a></dt>
<dd><blockquote>
<div><p>get_alpha_filter uses get_win to create a Tukey window via rotation to
pass to the medium.alpha_filter input field of the first order
simulation functions (kspaceFirstOrder1D, kspaceFirstOrder2D, and
kspaceFirstOrder3D). This parameter is used to regularise time
reversal image reconstruction when absorption compensation is
included.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kgrid</strong> (<a class="reference internal" href="kwave.kgrid.html#kwave.kgrid.kWaveGrid" title="kwave.kgrid.kWaveGrid"><em>kWaveGrid</em></a>) – </p></li>
<li><p><strong>medium</strong> (<em>Medium</em>) – </p></li>
<li><p><strong>filter_cutoff</strong> (<em>list</em>) – Any of the filter_cutoff inputs may be set to ‘max’ to set the cutoff frequency to the maximum frequency supported by the grid</p></li>
<li><p><strong>taper_ratio</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>alpha_filter</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.signals.get_wave_number">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.signals.</span></span><span class="sig-name descname"><span class="pre">get_wave_number</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Nx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/signals.html#get_wave_number"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.signals.get_wave_number" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.signals.get_win">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.signals.</span></span><span class="sig-name descname"><span class="pre">get_win</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_win</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">square</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/signals.html#get_win"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.signals.get_win" title="Permalink to this definition">#</a></dt>
<dd><blockquote>
<div><p>Return a frequency domain windowing function
getWin returns a 1D, 2D, or 3D frequency domain window of the
specified type of the given dimensions. By default, higher
dimensional windows are created using the outer product. The windows
can alternatively be created using rotation by setting the optional
input ‘Rotation’ to true. The coherent gain of the window can also be
returned.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>List</em><em>[</em><em>int</em><em>]</em><em>]</em>) – <ul>
<li><p>number of samples, use. N = Nx for 1D | N = [Nx Ny] for 2D | N = [Nx Ny Nz] for 3D</p></li>
</ul>
</p></li>
<li><p><strong>type</strong> – <ul>
<li><dl class="simple">
<dt>window type. Supported values are</dt><dd><p>’Bartlett’
‘Bartlett-Hanning’
‘Blackman’
‘Blackman-Harris’
‘Blackman-Nuttall’
‘Cosine’
‘Flattop’
‘Gaussian’
‘HalfBand’
‘Hamming’
‘Hanning’
‘Kaiser’
‘Lanczos’
‘Nuttall’
‘Rectangular’
‘Triangular’
‘Tukey’</p>
</dd>
</dl>
</li>
</ul>
<dl>
<dt>plot_win:      - Boolean controlling whether the window is displayed</dt><dd><p>(default = false).</p>
</dd>
<dt>param:     Control parameter for the Tukey, Blackman, Gaussian,</dt><dd><p>and Kaiser windows:</p>
<p>Tukey: taper ratio (default = 0.5)
Blackman: alpha (default = 0.16)
Gaussian: standard deviation (default = 0.5)
Kaiser: alpha (default = 3)</p>
</dd>
<dt>rotation:  - Boolean controlling whether 2D and 3D windows are</dt><dd><p>created via rotation or the outer product (default =
false). Windows created via rotation will have edge
values outside the window radius set to the first
window value.</p>
</dd>
<dt>symmetric: - Boolean controlling whether the window is symmetrical</dt><dd><p>(default = true). If set to false, a window of length N
+ 1 is created and the first N points are returned. For
2D and 3D windows, ‘Symmetric’ can be defined as a
vector defining the symmetry in each matrix dimension.</p>
</dd>
<dt>square:    - Boolean controlling whether the window is forced to</dt><dd><p>be square (default = false). If set to true and Nx
and Nz are not equal, the window is created using the
smaller variable, and then padded with zeros.</p>
</dd>
</dl>
</p></li>
<li><p><strong>type_</strong> (<em>str</em>) – </p></li>
<li><p><strong>plot_win</strong> (<em>bool</em>) – </p></li>
<li><p><strong>param</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – </p></li>
<li><p><strong>rotation</strong> (<em>bool</em>) – </p></li>
<li><p><strong>symmetric</strong> (<em>bool</em>) – </p></li>
<li><p><strong>square</strong> (<em>bool</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the window
cg: the coherent gain of the window</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>win</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.signals.gradient_spect">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.signals.</span></span><span class="sig-name descname"><span class="pre">gradient_spect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/signals.html#gradient_spect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.signals.gradient_spect" title="Permalink to this definition">#</a></dt>
<dd><p>gradient_spect calculates the gradient of an n-dimensional input
matrix using the Fourier collocation spectral method. The gradient
for singleton dimensions is returned as 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> – </p></li>
<li><p><strong>dn</strong> – </p></li>
<li><p><strong>dim</strong> – </p></li>
<li><p><strong>deriv_order</strong> – </p></li>
</ul>
</dd>
</dl>
<p>Returns:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.signals.reorder_binary_sensor_data">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.signals.</span></span><span class="sig-name descname"><span class="pre">reorder_binary_sensor_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sensor_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reorder_index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/signals.html#reorder_binary_sensor_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.signals.reorder_binary_sensor_data" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sensor_data</strong> (<em>ndarray</em>) – N x K</p></li>
<li><p><strong>reorder_index</strong> (<em>ndarray</em>) – N</p></li>
</ul>
</dd>
</dl>
<p>Returns:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.signals.reorder_sensor_data">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.signals.</span></span><span class="sig-name descname"><span class="pre">reorder_sensor_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kgrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensor_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/signals.html#reorder_sensor_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.signals.reorder_sensor_data" title="Permalink to this definition">#</a></dt>
<dd><p>Reorders the sensor data based on the coordinates of the sensor points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kgrid</strong> (<em>object</em>) – The k-Wave grid object.</p></li>
<li><p><strong>sensor</strong> (<em>object</em>) – The k-Wave sensor object.</p></li>
<li><p><strong>sensor_data</strong> (<em>np.ndarray</em>) – The sensor data to be reordered.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The reordered sensor data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the simulation is not 2D or the sensor is not defined as a binary mask.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.signals.tone_burst">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.signals.</span></span><span class="sig-name descname"><span class="pre">tone_burst</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_cycles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">envelope</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_signal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/signals.html#tone_burst"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.signals.tone_burst" title="Permalink to this definition">#</a></dt>
<dd><blockquote>
<div><p>Create an enveloped single frequency tone burst.
tone_burst creates an enveloped single frequency tone burst for use in
ultrasound simulations. If an array is given for the optional input
‘SignalOffset’, a matrix of tone bursts is created where each row
corresponds to a tone burst for each value of the ‘SignalOffset’. If
a value for the optional input ‘SignalLength’ is  given, the tone
burst/s are zero padded to this length (in samples).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plot_signal</strong> – </p></li>
<li><p><strong>signal_offset</strong> – </p></li>
<li><p><strong>signal_length</strong> – </p></li>
<li><p><strong>plot</strong> – </p></li>
<li><p><strong>sample_freq</strong> – sampling frequency [Hz]</p></li>
<li><p><strong>signal_freq</strong> – frequency of the tone burst signal [Hz]</p></li>
<li><p><strong>num_cycles</strong> – number of sinusoidal oscillations</p></li>
<li><p><strong>INPUTS</strong> (<em>OPTIONAL</em>) – <p>Optional ‘string’, value pairs that may be used to modify the default
computational settings.</p>
<dl>
<dt>envelope:      - Envelope used to taper the tone burst. Valid inputs</dt><dd><p>are:</p>
<blockquote>
<div><p>’Gaussian’ (the default)
‘Rectangular’
[num_ring_up_cycles, num_ring_down_cycles]</p>
</div></blockquote>
<p>The last option generates a continuous wave signal
with a cosine taper of the specified length at the
beginning and end.</p>
</dd>
<dt>plot:             Boolean controlling whether the created tone</dt><dd><p>burst is plotted.</p>
</dd>
<dt>signal_length:    Signal length in number of samples, if longer</dt><dd><p>than the tone burst length, the signal is
appended with zeros.</p>
</dd>
<dt>signal_offset:    Signal offset before the tone burst starts in</dt><dd><p>number of samples.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
<p>Returns: created tone burst</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.signals.unmask_sensor_data">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.signals.</span></span><span class="sig-name descname"><span class="pre">unmask_sensor_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kgrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensor_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/signals.html#unmask_sensor_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.signals.unmask_sensor_data" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sensor_data</strong> (<em>ndarray</em>) – </p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>ndarray</em></p>
</dd>
</dl>
</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="kwave.utils.tictoc.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">kwave.utils.tictoc module</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="kwave.utils.pml.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">kwave.utils.pml module</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, Walter Simson, Farid Yagubbayli
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">kwave.utils.signals module</a><ul>
<li><a class="reference internal" href="#kwave.utils.signals.add_noise"><code class="docutils literal notranslate"><span class="pre">add_noise()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.signals.calc_max_freq"><code class="docutils literal notranslate"><span class="pre">calc_max_freq()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.signals.create_cw_signals"><code class="docutils literal notranslate"><span class="pre">create_cw_signals()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.signals.get_alpha_filter"><code class="docutils literal notranslate"><span class="pre">get_alpha_filter()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.signals.get_wave_number"><code class="docutils literal notranslate"><span class="pre">get_wave_number()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.signals.get_win"><code class="docutils literal notranslate"><span class="pre">get_win()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.signals.gradient_spect"><code class="docutils literal notranslate"><span class="pre">gradient_spect()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.signals.reorder_binary_sensor_data"><code class="docutils literal notranslate"><span class="pre">reorder_binary_sensor_data()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.signals.reorder_sensor_data"><code class="docutils literal notranslate"><span class="pre">reorder_sensor_data()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.signals.tone_burst"><code class="docutils literal notranslate"><span class="pre">tone_burst()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.signals.unmask_sensor_data"><code class="docutils literal notranslate"><span class="pre">unmask_sensor_data()</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    </body>
</html>