<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="kwave.utils.interp module" href="kwave.utils.interp.html" /><link rel="prev" title="kwave.utils.dotdictionary module" href="kwave.utils.dotdictionary.html" />

    <!-- Generated with Sphinx 6.2.1 and Furo 2022.12.07 -->
        <title>kwave.utils.filters module - k-wave-python documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=91d0f0d1c444bdcb17a68e833c7a53903343c195" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-toolbox-code.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">k-wave-python  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">k-wave-python  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="get_started/contrib.html">Contribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="get_started/license.html">License</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="development/development_environment.html">Development Environment</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">kwave</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="kwave.data.html">kwave.data module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.enums.html">kwave.enums module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.executor.html">kwave.executor module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.kWaveSimulation.html">kwave.kWaveSimulation module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.kgrid.html">kwave.kgrid module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.kmedium.html">kwave.kmedium module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.ksensor.html">kwave.ksensor module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.ksource.html">kwave.ksource module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.kspaceFirstOrder.html">kwave.kspaceFirstOrder module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.kspaceFirstOrder2D.html">kwave.kspaceFirstOrder2D module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.kspaceFirstOrder3D.html">kwave.kspaceFirstOrder3D module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.kspaceFirstOrderAS.html">kwave.kspaceFirstOrderAS module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.ktransducer.html">kwave.ktransducer module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.options.html">kwave.options module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.recorder.html">kwave.recorder module</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="kwave.utils.html">kwave.utils package</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.checks.html">kwave.utils.checks module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.colormap.html">kwave.utils.colormap module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.conversion.html">kwave.utils.conversion module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.data.html">kwave.utils.data module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.dotdictionary.html">kwave.utils.dotdictionary module</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">kwave.utils.filters module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.interp.html">kwave.utils.interp module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.io.html">kwave.utils.io module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.mapgen.html">kwave.utils.mapgen module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.math.html">kwave.utils.math module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.matrix.html">kwave.utils.matrix module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.pml.html">kwave.utils.pml module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.signals.html">kwave.utils.signals module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.tictoc.html">kwave.utils.tictoc module</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="kwave.kWaveSimulation_helper.html">kwave.kWaveSimulation_helper package</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.create_absorption_variables.html">kwave.kWaveSimulation_helper.create_absorption_variables module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.create_storage_variables.html">kwave.kWaveSimulation_helper.create_storage_variables module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.data_cast.html">kwave.kWaveSimulation_helper.data_cast module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.display_simulation_params.html">kwave.kWaveSimulation_helper.display_simulation_params module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.expand_grid_matrices.html">kwave.kWaveSimulation_helper.expand_grid_matrices module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.retract_transducer_grid_size.html">kwave.kWaveSimulation_helper.retract_transducer_grid_size module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.save_to_disk_func.html">kwave.kWaveSimulation_helper.save_to_disk_func module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.scale_source_terms_func.html">kwave.kWaveSimulation_helper.scale_source_terms_func module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.set_sound_speed_ref.html">kwave.kWaveSimulation_helper.set_sound_speed_ref module</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="kwave.reconstruction.html">kwave.reconstruction package</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="kwave.reconstruction.beamform.html">kwave.reconstruction.beamform module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.reconstruction.converter.html">kwave.reconstruction.converter module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.reconstruction.shifted_transform.html">kwave.reconstruction.shifted_transform module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.reconstruction.tools.html">kwave.reconstruction.tools module</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="edit-this-page">
  <a class="muted-link" href="https://github.com/waltsims/k-wave-python/edit/master/docs/kwave.utils.filters.rst" title="Edit this page">
    <svg aria-hidden="true" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" />
      <line x1="13.5" y1="6.5" x2="17.5" y2="10.5" />
    </svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="module-kwave.utils.filters">
<span id="kwave-utils-filters-module"></span><h1>kwave.utils.filters module<a class="headerlink" href="#module-kwave.utils.filters" title="Permalink to this heading">#</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.filters.apply_filter">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.filters.</span></span><span class="sig-name descname"><span class="pre">apply_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_band_atten</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">60</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/filters.html#apply_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.filters.apply_filter" title="Permalink to this definition">#</a></dt>
<dd><p>Filters an input signal using a FIR filter with Kaiser window coefficients based on the specified cut-off frequency and filter type.
Both causal and zero phase filters can be applied.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<em>ndarray</em>) – The input signal.</p></li>
<li><p><strong>Fs</strong> (<em>float</em>) – The sampling frequency of the signal.</p></li>
<li><p><strong>cutoff_f</strong> (<em>float</em>) – The cut-off frequency of the filter.</p></li>
<li><p><strong>filter_type</strong> (<em>str</em>) – The type of filter to apply, either ‘HighPass’, ‘LowPass’ or ‘BandPass’.</p></li>
<li><p><strong>zero_phase</strong> (<em>bool</em><em> | </em><em>None</em>) – Whether to apply a zero-phase filter. Defaults to False.</p></li>
<li><p><strong>transition_width</strong> (<em>float</em><em> | </em><em>None</em>) – The transition width of the filter, as a proportion of the sampling frequency. Defaults to 0.1.</p></li>
<li><p><strong>stop_band_atten</strong> (<em>int</em><em> | </em><em>None</em>) – The stop-band attenuation of the filter in dB. Defaults to 60.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The filtered signal.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>ndarray</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.filters.brenner_sharpness">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.filters.</span></span><span class="sig-name descname"><span class="pre">brenner_sharpness</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/filters.html#brenner_sharpness"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.filters.brenner_sharpness" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.filters.extract_amp_phase">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.filters.</span></span><span class="sig-name descname"><span class="pre">extract_amp_phase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fft_padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Hanning'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/filters.html#extract_amp_phase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.filters.extract_amp_phase" title="Permalink to this definition">#</a></dt>
<dd><p>Extract the amplitude and phase information at a specified frequency from a vector or matrix of time series data.</p>
<p>The amplitude and phase are extracted from the frequency spectrum, which is calculated using a windowed and zero
padded FFT. The values are extracted at the frequency closest to source_freq. By default, the time dimension is set
to the highest non-singleton dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>ndarray</em>) – Matrix of time signals [s]</p></li>
<li><p><strong>Fs</strong> (<em>float</em>) – Sampling frequency [Hz]</p></li>
<li><p><strong>source_freq</strong> (<em>float</em>) – Frequency at which the amplitude and phase should be extracted [Hz]</p></li>
<li><p><strong>dim</strong> (<em>Tuple</em><em>[</em><em>str</em><em>, </em><em>int</em><em>]</em>) – The time dimension of the input data. If ‘auto’, the highest non-singleton dimension is used.</p></li>
<li><p><strong>fft_padding</strong> (<em>int</em>) – The amount of zero padding to apply to the FFT.</p></li>
<li><p><strong>window</strong> (<em>str</em>) – The windowing function to use for the FFT.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple of the amplitude, phase and frequency of the extracted signal.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[<em>ndarray</em>, <em>ndarray</em>, <em>ndarray</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.filters.filter_time_series">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.filters.</span></span><span class="sig-name descname"><span class="pre">filter_time_series</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kgrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">medium</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ppw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rppw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_band_atten</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">60</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zerophase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_spectrums</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_signals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/filters.html#filter_time_series"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.filters.filter_time_series" title="Permalink to this definition">#</a></dt>
<dd><p>Filters a time-domain signal using the Kaiser windowing method.</p>
<p>The filter is designed to attenuate high-frequency noise in the signal while preserving
the signal’s important features. The filter design parameters can be adjusted to trade off
between the amount of noise reduction and the amount of signal distortion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kgrid</strong> (<a class="reference internal" href="kwave.kgrid.html#kwave.kgrid.kWaveGrid" title="kwave.kgrid.kWaveGrid"><em>kWaveGrid</em></a>) – The kWaveGrid grid.</p></li>
<li><p><strong>medium</strong> (<a class="reference internal" href="kwave.kmedium.html#kwave.kmedium.kWaveMedium" title="kwave.kmedium.kWaveMedium"><em>kWaveMedium</em></a>) – The kWavemedium.</p></li>
<li><p><strong>signal</strong> (<em>ndarray</em>) – The time-domain signal to filter.</p></li>
<li><p><strong>ppw</strong> (<em>int</em><em> | </em><em>None</em>) – The minimum number of points per wavelength in the signal. This determines the
minimum frequency that will be passed through the filter. Higher values of ppw
result in a lower cut-off frequency and more noise reduction, but may also result
in more signal distortion. Defaults to 3.</p></li>
<li><p><strong>rppw</strong> (<em>int</em><em> | </em><em>None</em>) – The number of points per wavelength in the smoothing ramp applied to the beginning
of the signal. This can be used to reduce ringing artifacts caused by the sudden
transition from the filtered signal to the unfiltered signal. Defaults to 0.</p></li>
<li><p><strong>stop_band_atten</strong> (<em>int</em><em> | </em><em>None</em>) – The stop-band attenuation in dB. This determines the steepness of the
filter’s transition from the pass-band to the stop-band. Higher values result in a
steeper transition and more noise reduction, but may also result in more signal
distortion. Defaults to 60.</p></li>
<li><p><strong>transition_width</strong> (<em>float</em><em> | </em><em>None</em>) – The transition width as a proportion of the sampling frequency. This
determines the width of the transition region between the pass-band and the stop-band.
Smaller values result in a narrower transition and more noise reduction, but may also
result in more signal distortion. Defaults to 0.1.</p></li>
<li><p><strong>zerophase</strong> (<em>bool</em><em> | </em><em>None</em>) – Whether to implement the filter as a zero-phase filter. Zero-phase filtering
can be used to preserve the phase information in the signal, which can be important
for some applications. However, it may also result in more signal distortion.
Defaults to False.</p></li>
<li><p><strong>plot_spectrums</strong> (<em>bool</em><em> | </em><em>None</em>) – Whether to plot the spectrums of the input and filtered signals.
Defaults to False.</p></li>
<li><p><strong>plot_signals</strong> (<em>bool</em><em> | </em><em>None</em>) – Whether to plot the input and filtered signals. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Checks correctness of passed arguments.</p></li>
<li><p><strong>NotImplementedError</strong> – Cannot currently plot anything.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The filtered signal.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>ndarray</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.filters.fwhm">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.filters.</span></span><span class="sig-name descname"><span class="pre">fwhm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/filters.html#fwhm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.filters.fwhm" title="Permalink to this definition">#</a></dt>
<dd><p>fwhm calculates the Full Width at Half Maximum (FWHM) of a positive
1D input function f(x) with spacing given by x.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> – f(x)</p></li>
<li><p><strong>x</strong> – x</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>FWHM of f(x)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.filters.gaussian_filter">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.filters.</span></span><span class="sig-name descname"><span class="pre">gaussian_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bandwidth</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/filters.html#gaussian_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.filters.gaussian_filter" title="Permalink to this definition">#</a></dt>
<dd><p>Applies a frequency domain Gaussian filter with the
specified center frequency and percentage bandwidth to the input
signal. If the input signal is given as a matrix, the filter is
applied to each matrix row.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<em>ndarray</em><em> | </em><em>List</em><em>[</em><em>float</em><em>]</em>) – Signal to filter</p></li>
<li><p><strong>Fs</strong> (<em>float</em>) – Sampling frequency [Hz]</p></li>
<li><p><strong>frequency</strong> (<em>float</em>) – Center frequency of filter [Hz]</p></li>
<li><p><strong>bandwidth</strong> (<em>float</em>) – Bandwidth of filter in percentage</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The filtered signal</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>ndarray</em> | <em>List</em>[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.filters.sharpness">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.filters.</span></span><span class="sig-name descname"><span class="pre">sharpness</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Brenner'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/filters.html#sharpness"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.filters.sharpness" title="Permalink to this definition">#</a></dt>
<dd><p>Returns a scalar metric related to the sharpness of a 2D or 3D image matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>im</strong> (<em>ndarray</em>) – The image matrix.</p></li>
<li><p><strong>metric</strong> – The metric to use. Defaults to “Brenner”.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em> | </em><em>None</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A scalar sharpness metric.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>AssertionError</strong> – If <cite>im</cite> is not a NumPy array.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>B. E. Treeby, T. K. Varslot, E. Z. Zhang, J. G. Laufer, and P. C. Beard, “Automatic sound speed selection in
photoacoustic image reconstruction using an autofocus approach,” J. Biomed. Opt., vol. 16, no. 9, p. 090501, 2011.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.filters.single_sided_correction">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.filters.</span></span><span class="sig-name descname"><span class="pre">single_sided_correction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func_fft</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fft_len</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/filters.html#single_sided_correction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.filters.single_sided_correction" title="Permalink to this definition">#</a></dt>
<dd><p>Correct the single-sided magnitude by multiplying the symmetric points by 2.</p>
<p>The DC and Nyquist components are unique and are not multiplied by 2.
The Nyquist component only exists for even numbered FFT lengths.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func_fft</strong> (<em>ndarray</em>) – The FFT of the function to be corrected.</p></li>
<li><p><strong>fft_len</strong> (<em>int</em>) – The length of the FFT.</p></li>
<li><p><strong>dim</strong> (<em>int</em>) – The number of dimensions of <cite>func_fft</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The corrected FFT of the function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>ndarray</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.filters.smooth">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.filters.</span></span><span class="sig-name descname"><span class="pre">smooth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restore_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Blackman'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/filters.html#smooth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.filters.smooth" title="Permalink to this definition">#</a></dt>
<dd><p>Smooths a matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>ndarray</em>) – The spatial distribution to smooth.</p></li>
<li><p><strong>restore_max</strong> (<em>bool</em><em> | </em><em>None</em>) – Boolean controlling whether the maximum value is restored after smoothing. Defaults to False.</p></li>
<li><p><strong>window_type</strong> (<em>str</em><em> | </em><em>None</em>) – Shape of the smoothing window. Any valid inputs to get_win are supported. Defaults to ‘Blackman’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The smoothed matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>a_sm</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.filters.spect">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.filters.</span></span><span class="sig-name descname"><span class="pre">spect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fft_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">power_two</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unwrap_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Rectangular'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/filters.html#spect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.filters.spect" title="Permalink to this definition">#</a></dt>
<dd><p>Calculates the spectrum of a signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>ndarray</em>) – The signal to analyse.</p></li>
<li><p><strong>Fs</strong> (<em>float</em>) – The sampling frequency in Hz.</p></li>
<li><p><strong>dim</strong> (<em>int</em><em> | </em><em>str</em><em> | </em><em>None</em>) – The dimension over which the spectrum is calculated. Defaults to ‘auto’.</p></li>
<li><p><strong>fft_len</strong> (<em>int</em><em> | </em><em>None</em>) – The length of the FFT. If the set length is smaller than the signal length, the default value is used
instead (default = signal length).</p></li>
<li><p><strong>power_two</strong> (<em>bool</em><em> | </em><em>None</em>) – Whether the FFT length is forced to be the next highest power of 2 (default = False).</p></li>
<li><p><strong>unwrap_phase</strong> (<em>bool</em><em> | </em><em>None</em>) – Whether to unwrap the phase spectrum (default = False).</p></li>
<li><p><strong>window</strong> (<em>str</em><em> | </em><em>None</em>) – (str) The window type used to filter the signal before the FFT is taken (default = ‘Rectangular’). Any valid
input types for get_win may be used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Frequency array
func_as: Single-sided amplitude spectrum
func_ps: Single-sided phase spectrum</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>f</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the input signal is scalar or has more than 4 dimensions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.filters.tenenbaum_sharpness">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.filters.</span></span><span class="sig-name descname"><span class="pre">tenenbaum_sharpness</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/filters.html#tenenbaum_sharpness"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.filters.tenenbaum_sharpness" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="kwave.utils.interp.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">kwave.utils.interp module</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="kwave.utils.dotdictionary.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">kwave.utils.dotdictionary module</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, Walter Simson, Farid Yagubbayli
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">kwave.utils.filters module</a><ul>
<li><a class="reference internal" href="#kwave.utils.filters.apply_filter"><code class="docutils literal notranslate"><span class="pre">apply_filter()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.filters.brenner_sharpness"><code class="docutils literal notranslate"><span class="pre">brenner_sharpness()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.filters.extract_amp_phase"><code class="docutils literal notranslate"><span class="pre">extract_amp_phase()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.filters.filter_time_series"><code class="docutils literal notranslate"><span class="pre">filter_time_series()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.filters.fwhm"><code class="docutils literal notranslate"><span class="pre">fwhm()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.filters.gaussian_filter"><code class="docutils literal notranslate"><span class="pre">gaussian_filter()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.filters.sharpness"><code class="docutils literal notranslate"><span class="pre">sharpness()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.filters.single_sided_correction"><code class="docutils literal notranslate"><span class="pre">single_sided_correction()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.filters.smooth"><code class="docutils literal notranslate"><span class="pre">smooth()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.filters.spect"><code class="docutils literal notranslate"><span class="pre">spect()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.filters.tenenbaum_sharpness"><code class="docutils literal notranslate"><span class="pre">tenenbaum_sharpness()</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    </body>
</html>