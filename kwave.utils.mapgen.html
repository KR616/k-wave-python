<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="kwave.utils.math module" href="kwave.utils.math.html" /><link rel="prev" title="kwave.utils.io module" href="kwave.utils.io.html" />

    <!-- Generated with Sphinx 6.2.1 and Furo 2022.12.07 -->
        <title>kwave.utils.mapgen module - k-wave-python documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=91d0f0d1c444bdcb17a68e833c7a53903343c195" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-toolbox-code.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">k-wave-python  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">k-wave-python  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="get_started/contrib.html">Contribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="get_started/license.html">License</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="development/development_environment.html">Development Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="development/development_environment.html#test-references">Test References</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">kwave</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="kwave.data.html">kwave.data module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.enums.html">kwave.enums module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.executor.html">kwave.executor module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.kWaveSimulation.html">kwave.kWaveSimulation module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.kgrid.html">kwave.kgrid module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.kmedium.html">kwave.kmedium module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.ksensor.html">kwave.ksensor module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.ksource.html">kwave.ksource module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.kspaceFirstOrder.html">kwave.kspaceFirstOrder module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.kspaceFirstOrder2D.html">kwave.kspaceFirstOrder2D module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.kspaceFirstOrder3D.html">kwave.kspaceFirstOrder3D module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.kspaceFirstOrderAS.html">kwave.kspaceFirstOrderAS module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.ktransducer.html">kwave.ktransducer module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.options.html">kwave.options module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.recorder.html">kwave.recorder module</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="kwave.utils.html">kwave.utils package</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.checks.html">kwave.utils.checks module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.colormap.html">kwave.utils.colormap module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.conversion.html">kwave.utils.conversion module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.data.html">kwave.utils.data module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.dotdictionary.html">kwave.utils.dotdictionary module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.filters.html">kwave.utils.filters module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.interp.html">kwave.utils.interp module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.io.html">kwave.utils.io module</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">kwave.utils.mapgen module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.math.html">kwave.utils.math module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.matrix.html">kwave.utils.matrix module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.pml.html">kwave.utils.pml module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.signals.html">kwave.utils.signals module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.tictoc.html">kwave.utils.tictoc module</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="kwave.kWaveSimulation_helper.html">kwave.kWaveSimulation_helper package</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.create_absorption_variables.html">kwave.kWaveSimulation_helper.create_absorption_variables module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.create_storage_variables.html">kwave.kWaveSimulation_helper.create_storage_variables module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.data_cast.html">kwave.kWaveSimulation_helper.data_cast module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.display_simulation_params.html">kwave.kWaveSimulation_helper.display_simulation_params module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.expand_grid_matrices.html">kwave.kWaveSimulation_helper.expand_grid_matrices module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.retract_transducer_grid_size.html">kwave.kWaveSimulation_helper.retract_transducer_grid_size module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.save_to_disk_func.html">kwave.kWaveSimulation_helper.save_to_disk_func module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.scale_source_terms_func.html">kwave.kWaveSimulation_helper.scale_source_terms_func module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.set_sound_speed_ref.html">kwave.kWaveSimulation_helper.set_sound_speed_ref module</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="kwave.reconstruction.html">kwave.reconstruction package</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="kwave.reconstruction.beamform.html">kwave.reconstruction.beamform module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.reconstruction.converter.html">kwave.reconstruction.converter module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.reconstruction.shifted_transform.html">kwave.reconstruction.shifted_transform module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.reconstruction.tools.html">kwave.reconstruction.tools module</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="edit-this-page">
  <a class="muted-link" href="https://github.com/waltsims/k-wave-python/edit/master/docs/kwave.utils.mapgen.rst" title="Edit this page">
    <svg aria-hidden="true" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" />
      <line x1="13.5" y1="6.5" x2="17.5" y2="10.5" />
    </svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="module-kwave.utils.mapgen">
<span id="kwave-utils-mapgen-module"></span><h1>kwave.utils.mapgen module<a class="headerlink" href="#module-kwave.utils.mapgen" title="Permalink to this heading">#</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.mapgen.create_pixel_dim">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.mapgen.</span></span><span class="sig-name descname"><span class="pre">create_pixel_dim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Nx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/mapgen.html#create_pixel_dim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.mapgen.create_pixel_dim" title="Permalink to this definition">#</a></dt>
<dd><p>Create an array of pixel dimensions and a pixel size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Nx</strong> (<em>int</em>) – The number of pixels in the x-dimension.</p></li>
<li><p><strong>origin_size</strong> (<em>float</em>) – The size of the origin in the x-dimension.</p></li>
<li><p><strong>shift</strong> (<em>float</em>) – The shift of the pixels in the x-dimension.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The pixel dimensions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[<em>ndarray</em>, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.mapgen.fit_power_law_params">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.mapgen.</span></span><span class="sig-name descname"><span class="pre">fit_power_law_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_fit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/mapgen.html#fit_power_law_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.mapgen.fit_power_law_params" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate absorption parameters that fit a power law over a given frequency range.</p>
<p>This function calculates the absorption parameters that should be defined in the simulation functions
to achieve the desired power law absorption behavior defined by <cite>a0</cite> and <cite>y</cite>. This takes into account
the actual absorption behavior exhibited by the fractional Laplacian wave equation.</p>
<p>This fitting is required when using large absorption values or high frequencies, as the fractional
Laplacian wave equation solved in <cite>kspaceFirstOrderND</cite> and <cite>kspaceSecondOrder</cite> no longer encapsulates
absorption of the form <cite>a = a0*f^y</cite>.</p>
<p>The returned values should be used to define <cite>medium.alpha_coeff</cite> and <cite>medium.alpha_power</cite> within the
simulation functions. The absorption behavior over the frequency range <cite>f_min</cite>:<cite>f_max</cite> will then
follow the power law defined by <cite>a0</cite> and <cite>y</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a0</strong> (<em>float</em>) – coefficient in the power law absorption equation</p></li>
<li><p><strong>y</strong> (<em>float</em>) – exponent in the power law absorption equation</p></li>
<li><p><strong>c0</strong> (<em>float</em>) – speed of sound in the medium</p></li>
<li><p><strong>f_min</strong> (<em>float</em>) – minimum frequency in the range to fit the power law</p></li>
<li><p><strong>f_max</strong> (<em>float</em>) – maximum frequency in the range to fit the power law</p></li>
<li><p><strong>plot_fit</strong> (<em>bool</em>) – whether to plot the fit</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple of the absorption coefficient and fitted exponent of the power law absorption equation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[float, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.mapgen.focused_bowl_oneil">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.mapgen.</span></span><span class="sig-name descname"><span class="pre">focused_bowl_oneil</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diameter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sound_speed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axial_positions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lateral_positions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/mapgen.html#focused_bowl_oneil"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.mapgen.focused_bowl_oneil" title="Permalink to this definition">#</a></dt>
<dd><p>Calculates O’Neil’s solution for the axial and lateral pressure amplitude generated by a focused bowl transducer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>float</em>) – The radius of the transducer.</p></li>
<li><p><strong>diameter</strong> (<em>float</em>) – The diameter of the transducer.</p></li>
<li><p><strong>velocity</strong> (<em>float</em>) – The normal surface velocity of the transducer.</p></li>
<li><p><strong>frequency</strong> (<em>float</em>) – The driving frequency of the sinusoid.</p></li>
<li><p><strong>sound_speed</strong> (<em>float</em>) – The sound speed in the medium.</p></li>
<li><p><strong>density</strong> (<em>float</em>) – The density of the medium.</p></li>
<li><p><strong>axial_positions</strong> (<em>ndarray</em><em> | </em><em>float</em><em> | </em><em>list</em><em> | </em><em>None</em>) – The positions along the beam axis where the pressure is evaluated (0 corresponds to the transducer surface). Set to [] to return only lateral pressure.</p></li>
<li><p><strong>lateral_positions</strong> (<em>ndarray</em><em> | </em><em>float</em><em> | </em><em>list</em><em> | </em><em>None</em>) – The lateral positions through the geometric focus where the pressure is evaluated (0 corresponds to the beam axis). Set to [] to return only axial pressure.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The axial pressure amplitude.
p-lateral: The lateral pressure amplitude.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>p-axial</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p># define transducer parameters
radius = 140e-3  # [m]
diameter = 120e-3  # [m]
velocity = 100e-3  # [m / s]
frequency = 1e6  # [Hz]
sound_speed = 1500  # [m / s]
density = 1000  # [kg / m ^ 3]</p>
<p># define position vectors
axial_position = np.arange(0, 250e-3 + 1e-4, 1e-4)  # [m]
lateral_position = np.arange(-15e-3, 15e-3 + 1e-4, 1e-4)  # [m]</p>
<p># evaluate pressure
[p_axial, p_lateral] = focused_bowl_oneil(radius, diameter,</p>
<blockquote>
<div><p>velocity, frequency, sound_speed, density,
axial_position, lateral_position)</p>
</div></blockquote>
<p class="rubric">References</p>
<p>O’Neil, H. (1949). Theory of focusing radiators. J. Acoust. Soc. Am., 21(5), 516-526.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.mapgen.get_spaced_points">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.mapgen.</span></span><span class="sig-name descname"><span class="pre">get_spaced_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/mapgen.html#get_spaced_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.mapgen.get_spaced_points" title="Permalink to this definition">#</a></dt>
<dd><p>Generate a row vector of either logarithmically or linearly spaced points between <cite>start</cite> and <cite>stop</cite>.</p>
<p>When <cite>spacing</cite> is set to ‘linear’, the function is identical to the inbuilt <cite>np.linspace</cite> function.
When <cite>spacing</cite> is set to ‘log’, the function is similar to the inbuilt <cite>np.logspace</cite> function, except
that <cite>start</cite> and <cite>stop</cite> define the start and end numbers, not decades. For logarithmically spaced
points, <cite>start</cite> must be &gt; 0. If <cite>n</cite> &lt; 2, <cite>stop</cite> is returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<em>float</em>) – start value for the spaced points</p></li>
<li><p><strong>stop</strong> (<em>float</em>) – end value for the spaced points</p></li>
<li><p><strong>n</strong> (<em>int</em>) – number of points to generate</p></li>
<li><p><strong>spacing</strong> (<em>str</em>) – type of spacing to use, either ‘linear’ or ‘log’</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>row vector of spaced points</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>points</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – if <cite>stop</cite> &lt;= <cite>start</cite> or <cite>spacing</cite> is not ‘linear’ or ‘log’</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.mapgen.make_arc">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.mapgen.</span></span><span class="sig-name descname"><span class="pre">make_arc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arc_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diameter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">focus_pos</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/mapgen.html#make_arc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.mapgen.make_arc" title="Permalink to this definition">#</a></dt>
<dd><p>Generates an arc shape with a given radius, diameter, and focus position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid_size</strong> (<a class="reference internal" href="kwave.data.html#kwave.data.Vector" title="kwave.data.Vector"><em>Vector</em></a>) – The size of the grid, given as a 1D array with the number of pixels in each dimension.</p></li>
<li><p><strong>arc_pos</strong> (<em>ndarray</em>) – The position of the arc, given as a 1D array with the coordinates in each dimension.</p></li>
<li><p><strong>radius</strong> (<em>float</em>) – The radius of the arc.</p></li>
<li><p><strong>diameter</strong> (<em>float</em>) – The diameter of the arc.</p></li>
<li><p><strong>focus_pos</strong> (<a class="reference internal" href="kwave.data.html#kwave.data.Vector" title="kwave.data.Vector"><em>Vector</em></a>) – The position of the focus, given as a 1D array with the coordinates in each dimension.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 2D array with the arc shape.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.mapgen.make_ball">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.mapgen.</span></span><span class="sig-name descname"><span class="pre">make_ball</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ball_center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_ball</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/mapgen.html#make_ball"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.mapgen.make_ball" title="Permalink to this definition">#</a></dt>
<dd><p>Creates a binary map of a filled ball within a 3D grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid_size</strong> (<a class="reference internal" href="kwave.data.html#kwave.data.Vector" title="kwave.data.Vector"><em>Vector</em></a>) – size of the 3D grid in [grid points].</p></li>
<li><p><strong>ball_center</strong> (<a class="reference internal" href="kwave.data.html#kwave.data.Vector" title="kwave.data.Vector"><em>Vector</em></a>) – centre of the ball in [grid points]</p></li>
<li><p><strong>radius</strong> (<em>int</em>) – ball radius [grid points].</p></li>
<li><p><strong>plot_ball</strong> (<em>bool</em>) – whether to plot the ball using voxelPlot (default = False).</p></li>
<li><p><strong>binary</strong> (<em>bool</em>) – whether to return the ball map as a double precision matrix (False) or a logical matrix (True) (default = False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>3D binary map of a filled ball.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ball</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.mapgen.make_bowl">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.mapgen.</span></span><span class="sig-name descname"><span class="pre">make_bowl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bowl_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diameter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">focus_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_overlap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/mapgen.html#make_bowl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.mapgen.make_bowl" title="Permalink to this definition">#</a></dt>
<dd><p>Generate a matrix representing a bowl-shaped object in 3D space.</p>
<p>This function generates a 3D matrix representing a bowl-shaped object with the specified radius and diameter. The position
of the bowl and the focus point can be specified, as well as whether to return a binary matrix or a matrix with
continuous values. The optional parameter ‘remove_overlap’ can be used to remove any overlap with the surrounding grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid_size</strong> (<a class="reference internal" href="kwave.data.html#kwave.data.Vector" title="kwave.data.Vector"><em>Vector</em></a>) – size of the grid in each dimension</p></li>
<li><p><strong>bowl_pos</strong> (<a class="reference internal" href="kwave.data.html#kwave.data.Vector" title="kwave.data.Vector"><em>Vector</em></a>) – position of the bowl in the grid</p></li>
<li><p><strong>radius</strong> (<em>int</em>) – radius of the bowl</p></li>
<li><p><strong>diameter</strong> (<em>int</em>) – diameter of the bowl</p></li>
<li><p><strong>focus_pos</strong> (<a class="reference internal" href="kwave.data.html#kwave.data.Vector" title="kwave.data.Vector"><em>Vector</em></a>) – position of the focus point in the grid</p></li>
<li><p><strong>binary</strong> (<em>bool</em>) – whether to return a binary matrix</p></li>
<li><p><strong>remove_overlap</strong> (<em>bool</em>) – whether to remove overlap with the surrounding grid</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>3D matrix representing the bowl-shaped object</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matrix</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – if any of the input arguments are outside the valid range</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.mapgen.make_cart_circle">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.mapgen.</span></span><span class="sig-name descname"><span class="pre">make_cart_circle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Vector([0,</span> <span class="pre">0])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arc_angle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6.283185307179586</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_circle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/mapgen.html#make_cart_circle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.mapgen.make_cart_circle" title="Permalink to this definition">#</a></dt>
<dd><p>Create a set of points in cartesian coordinates defining a circle or arc.</p>
<p>This function creates a set of points in cartesian coordinates defining a circle or arc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>float</em>) – radius of the circle or arc</p></li>
<li><p><strong>num_points</strong> (<em>int</em>) – number of points to generate</p></li>
<li><p><strong>center_pos</strong> (<a class="reference internal" href="kwave.data.html#kwave.data.Vector" title="kwave.data.Vector"><em>Vector</em></a>) – center position of the circle or arc</p></li>
<li><p><strong>arc_angle</strong> (<em>float</em>) – arc angle in radians</p></li>
<li><p><strong>plot_circle</strong> (<em>bool</em>) – whether to plot the circle or arc</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2 x <cite>num_points</cite> array of cartesian coordinates</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>ndarray</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.mapgen.make_cart_rect">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.mapgen.</span></span><span class="sig-name descname"><span class="pre">make_cart_rect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rect_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Lx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ly</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_rect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/mapgen.html#make_cart_rect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.mapgen.make_cart_rect" title="Permalink to this definition">#</a></dt>
<dd><p>Create evenly distributed Cartesian points covering a rectangle.</p>
<p>Args:
rect_pos : List. Cartesian position of the centre of the rectangle.
Lx : Float. Height of the rectangle (along the x-coordinate before rotation).
Ly : Float. Width of the rectangle (along the y-coordinate before rotation).
theta : Float or List (Optional). Specifies the orientation of the rectangle.
num_points : int (Optional). Approximate number of points on the rectangle.
plot_rect : bool (Optional). Boolean controlling whether the Cartesian points are plotted.</p>
<p>Returns:
np.array. 2 x num_points* or 3 x num_points* array of Cartesian coordinates.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.mapgen.make_cart_sphere">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.mapgen.</span></span><span class="sig-name descname"><span class="pre">make_cart_sphere</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Vector([0,</span> <span class="pre">0,</span> <span class="pre">0])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_sphere</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/mapgen.html#make_cart_sphere"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.mapgen.make_cart_sphere" title="Permalink to this definition">#</a></dt>
<dd><p>Cart_sphere creates a set of points in Cartesian coordinates defining a sphere.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>float</em>) – the radius of the sphere.</p></li>
<li><p><strong>num_points</strong> (<em>int</em>) – the number of points to be generated.</p></li>
<li><p><strong>center_pos</strong> (<a class="reference internal" href="kwave.data.html#kwave.data.Vector" title="kwave.data.Vector"><em>Vector</em></a>) – the coordinates of the center of the sphere. Defaults to (0, 0, 0).</p></li>
<li><p><strong>plot_sphere</strong> (<em>bool</em>) – whether to plot the sphere. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The points on the sphere.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[<em>Tuple</em>[float, float, float]] | <em>Tuple</em>[<em>List</em>[<em>Tuple</em>[float, float, float]], <em>Any</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.mapgen.make_circle">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.mapgen.</span></span><span class="sig-name descname"><span class="pre">make_circle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arc_angle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_circle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/mapgen.html#make_circle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.mapgen.make_circle" title="Permalink to this definition">#</a></dt>
<dd><p>Create a binary map of a circle within a 2D grid.</p>
<p>This function creates a binary map of a circle (or arc) using the midpoint circle algorithm within a two-dimensional grid.
The circle position is denoted by 1’s in the matrix with 0’s elsewhere. A single grid point is taken as the circle
centre, so the total diameter will always be an odd number of grid points. The centre of the circle and the radius
are not constrained by the grid dimensions, so it is possible to create sections of circles or a blank image if none
of the circle intersects the grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid_size</strong> (<a class="reference internal" href="kwave.data.html#kwave.data.Vector" title="kwave.data.Vector"><em>Vector</em></a>) – A 2D vector of the grid size in grid points.</p></li>
<li><p><strong>center</strong> (<a class="reference internal" href="kwave.data.html#kwave.data.Vector" title="kwave.data.Vector"><em>Vector</em></a>) – A 2D vector of the circle centre in grid points.</p></li>
<li><p><strong>radius</strong> (<em>int</em>) – The radius of the circle.</p></li>
<li><p><strong>arc_angle</strong> (<em>float</em><em> | </em><em>None</em>) – The angle of the circular arc in degrees. If set to None, a full circle will be created.</p></li>
<li><p><strong>plot_circle</strong> (<em>bool</em>) – If set to True, the circle will be plotted using Matplotlib.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A binary map of the circle in the 2D grid.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>ndarray</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.mapgen.make_disc">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.mapgen.</span></span><span class="sig-name descname"><span class="pre">make_disc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_disc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/mapgen.html#make_disc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.mapgen.make_disc" title="Permalink to this definition">#</a></dt>
<dd><p>Create a binary map of a filled disc within a 2D grid.</p>
<p>This function creates a binary map of a filled disc within a two-dimensional grid. The disc position is denoted by 1’s
in the matrix with 0’s elsewhere. A single grid point is taken as the disc centre, so the total diameter of the disc
will always be an odd number of grid points. If used within a k-Wave grid where dx != dy, the disc will appear oval
shaped. If part of the disc overlaps the grid edge, the rest of the disc will wrap to the grid edge on the opposite
side.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid_size</strong> (<a class="reference internal" href="kwave.data.html#kwave.data.Vector" title="kwave.data.Vector"><em>Vector</em></a>) – A 2D vector of the grid size in grid points.</p></li>
<li><p><strong>center</strong> (<a class="reference internal" href="kwave.data.html#kwave.data.Vector" title="kwave.data.Vector"><em>Vector</em></a>) – A 2D vector of the disc centre in grid points.</p></li>
<li><p><strong>radius</strong> – The radius of the disc.</p></li>
<li><p><strong>plot_disc</strong> – If set to True, the disc will be plotted using Matplotlib.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A binary map of the disc in the 2D grid.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.mapgen.make_line">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.mapgen.</span></span><span class="sig-name descname"><span class="pre">make_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">startpoint</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endpoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/mapgen.html#make_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.mapgen.make_line" title="Permalink to this definition">#</a></dt>
<dd><p>Generate a line shape with a given start and end point, angle, or length.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid_size</strong> (<a class="reference internal" href="kwave.data.html#kwave.data.Vector" title="kwave.data.Vector"><em>Vector</em></a>) – The size of the grid in pixels.</p></li>
<li><p><strong>startpoint</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em>) – The start point of the line, given as a tuple of x and y coordinates.</p></li>
<li><p><strong>endpoint</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>] </em><em>| </em><em>None</em>) – The end point of the line, given as a tuple of x and y coordinates. If not specified, the line is drawn from the start point at a given angle and length.</p></li>
<li><p><strong>angle</strong> (<em>float</em><em> | </em><em>None</em>) – The angle of the line in radians, measured counterclockwise from the x-axis. If not specified, the line is drawn from the start point to the end point.</p></li>
<li><p><strong>length</strong> (<em>int</em><em> | </em><em>None</em>) – The length of the line in pixels. If not specified, the line is drawn from the start point to the end point.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 2D array of the same size as the input parameters, with a value of 1 for pixels that are part of the line and 0 for pixels that are not.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>line</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.mapgen.make_multi_arc">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.mapgen.</span></span><span class="sig-name descname"><span class="pre">make_multi_arc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arc_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diameter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">focus_pos</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/mapgen.html#make_multi_arc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.mapgen.make_multi_arc" title="Permalink to this definition">#</a></dt>
<dd><p>Generates a multi-arc mask for an image given the size of the grid, the positions and properties of the arcs, and the position of the focus.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid_size</strong> (<a class="reference internal" href="kwave.data.html#kwave.data.Vector" title="kwave.data.Vector"><em>Vector</em></a>) – The size of the grid (assumed to be square).</p></li>
<li><p><strong>arc_pos</strong> (<em>ndarray</em>) – An array containing the (x, y) coordinates of the center of each arc.</p></li>
<li><p><strong>radius</strong> (<em>int</em><em> | </em><em>ndarray</em>) – The radius of each arc. Can be a single value or an array with one value for each arc.</p></li>
<li><p><strong>diameter</strong> (<em>int</em><em> | </em><em>ndarray</em>) – The diameter of the arcs. Can be a single value or an array with one value for each arc.</p></li>
<li><p><strong>focus_pos</strong> (<em>ndarray</em>) – The (x, y) coordinates of the focus.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A binary mask of the arcs.
arcs_labelled: A labelled mask of the arcs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>arcs</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the shape of arc_pos is not (N, 2), if the number of rows in arc_pos and radius do not match, or if the number of rows in arc_pos and diameter do not match.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.mapgen.make_multi_bowl">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.mapgen.</span></span><span class="sig-name descname"><span class="pre">make_multi_bowl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bowl_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diameter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">focus_pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_overlap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/mapgen.html#make_multi_bowl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.mapgen.make_multi_bowl" title="Permalink to this definition">#</a></dt>
<dd><p>Generates a multi-bowl mask for an image given the size of the grid, the positions of the bowls, the radius of each bowl, the diameter of the bowls, and the position of the focus.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid_size</strong> (<em>int</em>) – The size of the grid (assumed to be square).</p></li>
<li><p><strong>bowl_pos</strong> (<em>List</em><em>[</em><em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em>) – A list of tuples containing the (x, y) coordinates of the center of each bowl.</p></li>
<li><p><strong>radius</strong> (<em>int</em>) – The radius of each bowl.</p></li>
<li><p><strong>diameter</strong> (<em>int</em>) – The diameter of the bowls.</p></li>
<li><p><strong>focus_pos</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em>) – The (x, y) coordinates of the focus.</p></li>
<li><p><strong>binary</strong> (<em>bool</em>) – Whether to return a binary mask (default: False).</p></li>
<li><p><strong>remove_overlap</strong> (<em>bool</em>) – Whether to remove overlap between the bowls (default: False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>bowls_labeled:</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bowls</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.mapgen.make_pixel_map">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.mapgen.</span></span><span class="sig-name descname"><span class="pre">make_pixel_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'single'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/mapgen.html#make_pixel_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.mapgen.make_pixel_map" title="Permalink to this definition">#</a></dt>
<dd><p>Generates a matrix with values of the distance of each pixel from the center of a grid.</p>
<p>This function generates a matrix populated with values of how far each pixel in a grid is from the center. The center
can be a single pixel or a double pixel, and the optional input parameter ‘OriginSize’ controls this. For grids where
the dimension size and center pixel size are not both odd or even, the optional input parameter ‘Shift’ can be used to
control the location of the center point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid_size</strong> (<a class="reference internal" href="kwave.data.html#kwave.data.Vector" title="kwave.data.Vector"><em>Vector</em></a>) – A 2D or 3D vector of the grid size in grid points.</p></li>
<li><p><strong>*args</strong> – additional optional arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>pixel-radius</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>r</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Single pixel origin size for odd and even (with ‘Shift’ = [1 1] and
[0 0], respectively) grid sizes:</p>
<blockquote>
<div><p>x x x       x x x x         x x x x
x 0 x       x x x x         x 0 x x
x x x       x x 0 x         x x x x</p>
<blockquote>
<div><p>x x x x         x x x x</p>
</div></blockquote>
<p>Double pixel origin size for even and odd (with ‘Shift’ = [1 1] and
[0 0], respectively) grid sizes:</p>
<p>x x x x      x x x x x        x x x x x
x 0 0 x      x x x x x        x 0 0 x x
x 0 0 x      x x 0 0 x        x 0 0 x x
x x x x      x x 0 0 x        x x x x x</p>
<blockquote>
<div><p>x x x x x        x x x x x</p>
</div></blockquote>
<p>By default, a single pixel centre is used which is shifted towards
the final row and column.</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.mapgen.make_pixel_map_plane">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.mapgen.</span></span><span class="sig-name descname"><span class="pre">make_pixel_map_plane</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/mapgen.html#make_pixel_map_plane"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.mapgen.make_pixel_map_plane" title="Permalink to this definition">#</a></dt>
<dd><p>Generates a pixel map of a plane with given normal vector and point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid_size</strong> (<a class="reference internal" href="kwave.data.html#kwave.data.Vector" title="kwave.data.Vector"><em>Vector</em></a>) – The size of the grid as a NumPy array [Nx, Ny, Nz].</p></li>
<li><p><strong>normal</strong> (<em>ndarray</em>) – The normal vector of the plane as a NumPy array [nx, ny, nz].</p></li>
<li><p><strong>point</strong> (<em>ndarray</em>) – A point on the plane as a NumPy array [px, py, pz].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 2D array with the distance of each pixel from the given plane.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pixel_map</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the normal vector is zero.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.mapgen.make_pixel_map_point">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.mapgen.</span></span><span class="sig-name descname"><span class="pre">make_pixel_map_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centre_pos</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/mapgen.html#make_pixel_map_point"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.mapgen.make_pixel_map_point" title="Permalink to this definition">#</a></dt>
<dd><p>Generates a map of the distance of each pixel from a given centre position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid_size</strong> (<a class="reference internal" href="kwave.data.html#kwave.data.Vector" title="kwave.data.Vector"><em>Vector</em></a>) – The size of the grid, given as a 1D array with the number of pixels in each dimension.</p></li>
<li><p><strong>centre_pos</strong> (<em>ndarray</em>) – The position of the centre, given as a 1D array with the coordinates in each dimension.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 2D array with the distance of each pixel from the given centre position.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <cite>grid_size</cite> and <cite>centre_pos</cite> do not have the same number of dimensions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.mapgen.make_sphere">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.mapgen.</span></span><span class="sig-name descname"><span class="pre">make_sphere</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_sphere</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/mapgen.html#make_sphere"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.mapgen.make_sphere" title="Permalink to this definition">#</a></dt>
<dd><p>Generates a sphere mask for a 3D grid given the dimensions of the grid, the radius of the sphere, and optional flags to plot the sphere and/or return a binary mask.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid_size</strong> (<a class="reference internal" href="kwave.data.html#kwave.data.Vector" title="kwave.data.Vector"><em>Vector</em></a>) – The size of the grid (assumed to be cubic).</p></li>
<li><p><strong>radius</strong> (<em>float</em>) – The radius of the sphere.</p></li>
<li><p><strong>plot_sphere</strong> (<em>bool</em>) – Whether to plot the sphere (default: False).</p></li>
<li><p><strong>binary</strong> (<em>bool</em>) – Whether to return a binary mask (default: False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The sphere mask as a NumPy array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>sphere</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.mapgen.make_spherical_section">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.mapgen.</span></span><span class="sig-name descname"><span class="pre">make_spherical_section</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_section</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/mapgen.html#make_spherical_section"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.mapgen.make_spherical_section" title="Permalink to this definition">#</a></dt>
<dd><p>Generates a spherical section mask given the radius and height of the section and optional parameters to specify the width and/or plot and return a binary mask.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>float</em>) – The radius of the spherical section.</p></li>
<li><p><strong>height</strong> (<em>float</em>) – The height of the spherical section.</p></li>
<li><p><strong>width</strong> (<em>float</em><em> | </em><em>None</em>) – The width of the spherical section (default: height).</p></li>
<li><p><strong>plot_section</strong> (<em>bool</em>) – Whether to plot the spherical section (default: False).</p></li>
<li><p><strong>binary</strong> (<em>bool</em>) – Whether to return a binary mask (default: False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The spherical section mask as a NumPy array.
dist_map: The distance map of the spherical section mask as a NumPy array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ss</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If the width is not an odd number.</p></li>
<li><p><strong>NotImplementedError</strong> – Plotting not currently supported.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.mapgen.ndgrid">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.mapgen.</span></span><span class="sig-name descname"><span class="pre">ndgrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/mapgen.html#ndgrid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.mapgen.ndgrid" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.mapgen.power_law_kramers_kronig">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.mapgen.</span></span><span class="sig-name descname"><span class="pre">power_law_kramers_kronig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/mapgen.html#power_law_kramers_kronig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.mapgen.power_law_kramers_kronig" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the variation in sound speed for an attenuating medium using the Kramers-Kronig for power law attenuation.</p>
<p>This function computes the variation in sound speed for an attenuating medium using the Kramers-Kronig
formula for power law attenuation, where <cite>att = a0 * w^y</cite>. The power law parameters must be in Nepers/m,
with the frequency in rad/s. The variation is given about the sound speed <cite>c0</cite> at a reference frequency <cite>w0</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w</strong> (<em>ndarray</em>) – input frequency array [rad/s]</p></li>
<li><p><strong>w0</strong> (<em>float</em>) – reference frequency [rad/s]</p></li>
<li><p><strong>c0</strong> (<em>float</em>) – sound speed at w0 [m/s]</p></li>
<li><p><strong>a0</strong> (<em>float</em>) – power law coefficient [Nepers/((rad/s)^y m)]</p></li>
<li><p><strong>y</strong> (<em>float</em>) – power law exponent, where 0 &lt; y &lt; 3</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Variation of sound speed with w [m/s]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>ndarray</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.mapgen.trim_cart_points">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.mapgen.</span></span><span class="sig-name descname"><span class="pre">trim_cart_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kgrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/mapgen.html#trim_cart_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.mapgen.trim_cart_points" title="Permalink to this definition">#</a></dt>
<dd><p>trim_cart_points filters a dim x num_points array of Cartesian points
so that only those within the bounds of a given kgrid remain.
:param kgrid: Object of the kWaveGrid class defining the Cartesian</p>
<blockquote>
<div><p>and k-space grid fields.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>points</strong> (<em>ndarray</em>) – dim x num_points array of Cartesian coordinates to trim [m].</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dim x num_points array of Cartesian coordinates that lie within the grid defined by kgrid [m].</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.mapgen.water_absorption">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.mapgen.</span></span><span class="sig-name descname"><span class="pre">water_absorption</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/mapgen.html#water_absorption"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.mapgen.water_absorption" title="Permalink to this definition">#</a></dt>
<dd><p>Calculates the ultrasonic absorption in distilled
water at a given temperature and frequency using a 7 th order
polynomial fitted to the data given by np.pinkerton(1949).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> – f frequency value [MHz]</p></li>
<li><p><strong>T</strong> – water temperature value [degC]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>absorption [dB / cm]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>abs</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">abs</span> <span class="o">=</span> <span class="n">waterAbsorption</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">References</p>
<p>[1] np.pinkerton(1949) “The Absorption of Ultrasonic Waves in Liquids
and its Relation to Molecular Constitution, ” Proceedings of the
Physical Society.Section B, 2, 129 - 141</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.mapgen.water_density">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.mapgen.</span></span><span class="sig-name descname"><span class="pre">water_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/mapgen.html#water_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.mapgen.water_density" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the density of air-saturated water with temperature.</p>
<p>This function calculates the density of air-saturated water at a given temperature using the 4th order polynomial
given by Jones [1].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>temp</strong> (<em>float</em>) – water temperature in the range 5 to 40 [degC]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>density of water [kg/m^3]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>density</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – if <cite>temp</cite> is not between 5 and 40</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>[1] F.E. Jones and G.L. Harris (1992) “ITS-90 Density of Water Formulation for Volumetric Standards Calibration,”
J. Res. Natl. Inst.Stand.Technol., 97(3), 335-340.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.mapgen.water_non_linearity">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.mapgen.</span></span><span class="sig-name descname"><span class="pre">water_non_linearity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/mapgen.html#water_non_linearity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.mapgen.water_non_linearity" title="Permalink to this definition">#</a></dt>
<dd><blockquote>
<div><p>Calculates the parameter of nonlinearity B/A at a
given temperature using a fourth-order polynomial fitted to the data
given by Beyer (1960).</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>temp</strong> (<em>float</em>) – water temperature in the range 0 to 100 [degC]</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>parameter of nonlinearity</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>BonA</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">BonA</span> <span class="o">=</span> <span class="n">waterNonlinearity</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><dl class="simple">
<dt>References:</dt><dd><p>[1] R. T Beyer (1960) “Parameter of nonlinearity in fluids,” J.
Acoust. Soc. Am., 32(6), 719-721.</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.utils.mapgen.water_sound_speed">
<span class="sig-prename descclassname"><span class="pre">kwave.utils.mapgen.</span></span><span class="sig-name descname"><span class="pre">water_sound_speed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/utils/mapgen.html#water_sound_speed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.utils.mapgen.water_sound_speed" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the sound speed in distilled water with temperature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>temp</strong> (<em>float</em>) – The temperature of the water in degrees Celsius.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The sound speed in distilled water in m/s.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>c</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – if <cite>temp</cite> is not between 0 and 95</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>Marczak, R. (1997). The sound velocity in water as a function of temperature. Journal of Research of the National Institute of Standards and Technology, 102(6), 561-567.</p>
</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="kwave.utils.math.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">kwave.utils.math module</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="kwave.utils.io.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">kwave.utils.io module</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, Walter Simson, Farid Yagubbayli
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">kwave.utils.mapgen module</a><ul>
<li><a class="reference internal" href="#kwave.utils.mapgen.create_pixel_dim"><code class="docutils literal notranslate"><span class="pre">create_pixel_dim()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.mapgen.fit_power_law_params"><code class="docutils literal notranslate"><span class="pre">fit_power_law_params()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.mapgen.focused_bowl_oneil"><code class="docutils literal notranslate"><span class="pre">focused_bowl_oneil()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.mapgen.get_spaced_points"><code class="docutils literal notranslate"><span class="pre">get_spaced_points()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.mapgen.make_arc"><code class="docutils literal notranslate"><span class="pre">make_arc()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.mapgen.make_ball"><code class="docutils literal notranslate"><span class="pre">make_ball()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.mapgen.make_bowl"><code class="docutils literal notranslate"><span class="pre">make_bowl()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.mapgen.make_cart_circle"><code class="docutils literal notranslate"><span class="pre">make_cart_circle()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.mapgen.make_cart_rect"><code class="docutils literal notranslate"><span class="pre">make_cart_rect()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.mapgen.make_cart_sphere"><code class="docutils literal notranslate"><span class="pre">make_cart_sphere()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.mapgen.make_circle"><code class="docutils literal notranslate"><span class="pre">make_circle()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.mapgen.make_disc"><code class="docutils literal notranslate"><span class="pre">make_disc()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.mapgen.make_line"><code class="docutils literal notranslate"><span class="pre">make_line()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.mapgen.make_multi_arc"><code class="docutils literal notranslate"><span class="pre">make_multi_arc()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.mapgen.make_multi_bowl"><code class="docutils literal notranslate"><span class="pre">make_multi_bowl()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.mapgen.make_pixel_map"><code class="docutils literal notranslate"><span class="pre">make_pixel_map()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.mapgen.make_pixel_map_plane"><code class="docutils literal notranslate"><span class="pre">make_pixel_map_plane()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.mapgen.make_pixel_map_point"><code class="docutils literal notranslate"><span class="pre">make_pixel_map_point()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.mapgen.make_sphere"><code class="docutils literal notranslate"><span class="pre">make_sphere()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.mapgen.make_spherical_section"><code class="docutils literal notranslate"><span class="pre">make_spherical_section()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.mapgen.ndgrid"><code class="docutils literal notranslate"><span class="pre">ndgrid()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.mapgen.power_law_kramers_kronig"><code class="docutils literal notranslate"><span class="pre">power_law_kramers_kronig()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.mapgen.trim_cart_points"><code class="docutils literal notranslate"><span class="pre">trim_cart_points()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.mapgen.water_absorption"><code class="docutils literal notranslate"><span class="pre">water_absorption()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.mapgen.water_density"><code class="docutils literal notranslate"><span class="pre">water_density()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.mapgen.water_non_linearity"><code class="docutils literal notranslate"><span class="pre">water_non_linearity()</span></code></a></li>
<li><a class="reference internal" href="#kwave.utils.mapgen.water_sound_speed"><code class="docutils literal notranslate"><span class="pre">water_sound_speed()</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    </body>
</html>