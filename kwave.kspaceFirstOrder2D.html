<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="kwave.kspaceFirstOrder3D module" href="kwave.kspaceFirstOrder3D.html" /><link rel="prev" title="kwave.kspaceFirstOrder module" href="kwave.kspaceFirstOrder.html" />

    <!-- Generated with Sphinx 6.2.1 and Furo 2022.12.07 -->
        <title>kwave.kspaceFirstOrder2D module - k-wave-python documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=91d0f0d1c444bdcb17a68e833c7a53903343c195" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-toolbox-code.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">k-wave-python  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">k-wave-python  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="get_started/contrib.html">Contribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="get_started/license.html">License</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="development/development_environment.html">Development Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="development/development_environment.html#test-references">Test References</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">kwave</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="kwave.data.html">kwave.data module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.enums.html">kwave.enums module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.executor.html">kwave.executor module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.kWaveSimulation.html">kwave.kWaveSimulation module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.kgrid.html">kwave.kgrid module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.kmedium.html">kwave.kmedium module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.ksensor.html">kwave.ksensor module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.ksource.html">kwave.ksource module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.kspaceFirstOrder.html">kwave.kspaceFirstOrder module</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">kwave.kspaceFirstOrder2D module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.kspaceFirstOrder3D.html">kwave.kspaceFirstOrder3D module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.kspaceFirstOrderAS.html">kwave.kspaceFirstOrderAS module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.ktransducer.html">kwave.ktransducer module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.options.html">kwave.options module</a></li>
<li class="toctree-l1"><a class="reference internal" href="kwave.recorder.html">kwave.recorder module</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="kwave.utils.html">kwave.utils package</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.checks.html">kwave.utils.checks module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.colormap.html">kwave.utils.colormap module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.conversion.html">kwave.utils.conversion module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.data.html">kwave.utils.data module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.dotdictionary.html">kwave.utils.dotdictionary module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.filters.html">kwave.utils.filters module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.interp.html">kwave.utils.interp module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.io.html">kwave.utils.io module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.mapgen.html">kwave.utils.mapgen module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.math.html">kwave.utils.math module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.matrix.html">kwave.utils.matrix module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.pml.html">kwave.utils.pml module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.signals.html">kwave.utils.signals module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.utils.tictoc.html">kwave.utils.tictoc module</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="kwave.kWaveSimulation_helper.html">kwave.kWaveSimulation_helper package</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.create_absorption_variables.html">kwave.kWaveSimulation_helper.create_absorption_variables module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.create_storage_variables.html">kwave.kWaveSimulation_helper.create_storage_variables module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.data_cast.html">kwave.kWaveSimulation_helper.data_cast module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.display_simulation_params.html">kwave.kWaveSimulation_helper.display_simulation_params module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.expand_grid_matrices.html">kwave.kWaveSimulation_helper.expand_grid_matrices module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.retract_transducer_grid_size.html">kwave.kWaveSimulation_helper.retract_transducer_grid_size module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.save_to_disk_func.html">kwave.kWaveSimulation_helper.save_to_disk_func module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.scale_source_terms_func.html">kwave.kWaveSimulation_helper.scale_source_terms_func module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.kWaveSimulation_helper.set_sound_speed_ref.html">kwave.kWaveSimulation_helper.set_sound_speed_ref module</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="kwave.reconstruction.html">kwave.reconstruction package</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="kwave.reconstruction.beamform.html">kwave.reconstruction.beamform module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.reconstruction.converter.html">kwave.reconstruction.converter module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.reconstruction.shifted_transform.html">kwave.reconstruction.shifted_transform module</a></li>
<li class="toctree-l2"><a class="reference internal" href="kwave.reconstruction.tools.html">kwave.reconstruction.tools module</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="edit-this-page">
  <a class="muted-link" href="https://github.com/waltsims/k-wave-python/edit/master/docs/kwave.kspaceFirstOrder2D.rst" title="Edit this page">
    <svg aria-hidden="true" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" />
      <line x1="13.5" y1="6.5" x2="17.5" y2="10.5" />
    </svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="module-kwave.kspaceFirstOrder2D">
<span id="kwave-kspacefirstorder2d-module"></span><h1>kwave.kspaceFirstOrder2D module<a class="headerlink" href="#module-kwave.kspaceFirstOrder2D" title="Permalink to this heading">#</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="kwave.kspaceFirstOrder2D.kspaceFirstOrder2D">
<span class="sig-prename descclassname"><span class="pre">kwave.kspaceFirstOrder2D.</span></span><span class="sig-name descname"><span class="pre">kspaceFirstOrder2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kgrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">medium</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simulation_options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">execution_options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/kspaceFirstOrder2D.html#kspaceFirstOrder2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.kspaceFirstOrder2D.kspaceFirstOrder2D" title="Permalink to this definition">#</a></dt>
<dd><p>2D time-domain simulation of wave propagation.</p>
<p>kspaceFirstOrder2D simulates the time-domain propagation of
compressional waves through a two-dimensional homogeneous or
heterogeneous acoustic medium given four input structures: kgrid,
medium, source, and sensor. The computation is based on a first-order
k-space model which accounts for power law absorption and a
heterogeneous sound speed and density. If medium.BonA is specified,
cumulative nonlinear effects are also modelled. At each time-step
(defined by kgrid.dt and kgrid.Nt or kgrid.t_array), the acoustic
field parameters at the positions defined by sensor.mask are recorded
and stored. If kgrid.t_array is set to ‘auto’, this array is
automatically generated using the makeTime method of the kWaveGrid
class. An anisotropic absorbing boundary layer called a perfectly
matched layer (PML) is implemented to prevent waves that leave one
side of the domain being reintroduced from the opposite side (a
consequence of using the FFT to compute the spatial derivatives in
the wave equation). This allows infinite domain simulations to be
computed using small computational grids.</p>
<p>For a homogeneous medium the formulation is exact and the time-steps
are only limited by the effectiveness of the perfectly matched layer.
For a heterogeneous medium, the solution represents a leap-frog
pseudospectral method with a k-space correction that improves the
accuracy of computing the temporal derivatives. This allows larger
time-steps to be taken for the same level of accuracy compared to
conventional pseudospectral time-domain methods. The computational
grids are staggered both spatially and temporally.</p>
<p>An initial pressure distribution can be specified by assigning a
matrix (the same size as the computational grid) of arbitrary numeric
values to source.p0. A time varying pressure source can similarly be
specified by assigning a binary matrix (i.e., a matrix of 1’s and 0’s
with the same dimensions as the computational grid) to source.p_mask
where the 1’s represent the grid points that form part of the source.
The time varying input signals are then assigned to source.p. This
can be a single time series (in which case it is applied to all
source elements), or a matrix of time series following the source
elements using MATLAB’s standard column-wise linear matrix index
ordering. A time varying velocity source can be specified in an
analogous fashion, where the source location is specified by
source.u_mask, and the time varying input velocity is assigned to
source.ux and source.uy.</p>
<p>The field values are returned as arrays of time series at the sensor
locations defined by sensor.mask. This can be defined in three
different ways. (1) As a binary matrix (i.e., a matrix of 1’s and 0’s
with the same dimensions as the computational grid) representing the
grid points within the computational grid that will collect the data.
(2) As the grid coordinates of two opposing corners of a rectangle in
the form [x1; y1; x2; y2]. This is equivalent to using a binary
sensor mask covering the same region, however, the output is indexed
differently as discussed below. (3) As a series of Cartesian
coordinates within the grid which specify the location of the
pressure values stored at each time step. If the Cartesian
coordinates don’t exactly match the coordinates of a grid point, the
output values are calculated via interpolation. The Cartesian points
must be given as a 2 by N matrix corresponding to the x and y
positions, respectively, where the Cartesian origin is assumed to be
in the center of the grid. If no output is required, the sensor input
can be replaced with an empty array [].</p>
<p>If sensor.mask is given as a set of Cartesian coordinates, the
computed sensor_data is returned in the same order. If sensor.mask is
given as a binary matrix, sensor_data is returned using MATLAB’s
standard column-wise linear matrix index ordering. In both cases, the
recorded data is indexed as sensor_data(sensor_point_index,
time_index). For a binary sensor mask, the field values at a
particular time can be restored to the sensor positions within the
computation grid using unmaskSensorData. If sensor.mask is given as a
list of opposing corners of a rectangle, the recorded data is indexed
as sensor_data(rect_index).p(x_index, y_index, time_index), where
x_index and y_index correspond to the grid index within the
rectangle, and rect_index corresponds to the number of rectangles if
more than one is specified.</p>
<p>By default, the recorded acoustic pressure field is passed directly
to the output sensor_data. However, other acoustic parameters can
also be recorded by setting sensor.record to a cell array of the form
{‘p’, ‘u’, ‘p_max’, …}. For example, both the particle velocity and
the acoustic pressure can be returned by setting sensor.record =
{‘p’, ‘u’}. If sensor.record is given, the output sensor_data is
returned as a structure with the different outputs appended as
structure fields. For example, if sensor.record = {‘p’, ‘p_final’,
‘p_max’, ‘u’}, the output would contain fields sensor_data.p,
sensor_data.p_final, sensor_data.p_max, sensor_data.ux, and
sensor_data.uy. Most of the output parameters are recorded at the
given sensor positions and are indexed as
sensor_data.field(sensor_point_index, time_index) or
sensor_data(rect_index).field(x_index, y_index, time_index) if using
a sensor mask defined as opposing rectangular corners. The exceptions
are the averaged quantities (‘p_max’, ‘p_rms’, ‘u_max’, ‘p_rms’,
‘I_avg’), the ‘all’ quantities (‘p_max_all’, ‘p_min_all’,
‘u_max_all’, ‘u_min_all’), and the final quantities (‘p_final’,
‘u_final’). The averaged quantities are indexed as
sensor_data.p_max(sensor_point_index) or
sensor_data(rect_index).p_max(x_index, y_index) if using rectangular
corners, while the final and ‘all’ quantities are returned over the
entire grid and are always indexed as sensor_data.p_final(nx, ny),
regardless of the type of sensor mask.</p>
<p>kspaceFirstOrder2D may also be used for time reversal image
reconstruction by assigning the time varying pressure recorded over
an arbitrary sensor surface to the input field
sensor.time_reversal_boundary_data. This data is then enforced in
time reversed order as a time varying Dirichlet boundary condition
over the sensor surface given by sensor.mask. The boundary data must
be indexed as sensor.time_reversal_boundary_data(sensor_point_index,
time_index). If sensor.mask is given as a set of Cartesian
coordinates, the boundary data must be given in the same order. An
equivalent binary sensor mask (computed using nearest neighbour
interpolation) is then used to place the pressure values into the
computational grid at each time step. If sensor.mask is given as a
binary matrix of sensor points, the boundary data must be ordered
using MATLAB’s standard column-wise linear matrix indexing. If no
additional inputs are required, the source input can be replaced with
an empty array [].</p>
<p>Acoustic attenuation compensation can also be included during time
reversal image reconstruction by assigning the absorption parameters
medium.alpha_coeff and medium.alpha_power and reversing the sign of
the absorption term by setting medium.alpha_sign = [-1, 1]. This
forces the propagating waves to grow according to the absorption
parameters instead of decay. The reconstruction should then be
regularised by assigning a filter to medium.alpha_filter (this can be
created using getAlphaFilter).</p>
<p>Note: To run a simple photoacoustic image reconstruction example
using time reversal (that commits the ‘inverse crime’ of using the
same numerical parameters and model for data simulation and image
reconstruction), the sensor_data returned from a k-Wave simulation
can be passed directly to sensor.time_reversal_boundary_data with the
input fields source.p0 and source.p removed or set to zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kgrid</strong> (<a class="reference internal" href="kwave.kgrid.html#kwave.kgrid.kWaveGrid" title="kwave.kgrid.kWaveGrid"><em>kWaveGrid</em></a>) – kWaveGrid instance</p></li>
<li><p><strong>medium</strong> (<a class="reference internal" href="kwave.kmedium.html#kwave.kmedium.kWaveMedium" title="kwave.kmedium.kWaveMedium"><em>kWaveMedium</em></a>) – kWaveMedium instance</p></li>
<li><p><strong>source</strong> (<a class="reference internal" href="kwave.ksource.html#kwave.ksource.kSource" title="kwave.ksource.kSource"><em>kSource</em></a>) – kWaveSource instance</p></li>
<li><p><strong>sensor</strong> (<a class="reference internal" href="kwave.ktransducer.html#kwave.ktransducer.NotATransducer" title="kwave.ktransducer.NotATransducer"><em>NotATransducer</em></a><em> | </em><a class="reference internal" href="kwave.ksensor.html#kwave.ksensor.kSensor" title="kwave.ksensor.kSensor"><em>kSensor</em></a>) – kWaveSensor instance</p></li>
<li><p><strong>**kwargs</strong> – </p></li>
<li><p><strong>simulation_options</strong> (<em>SimulationOptions</em>) – </p></li>
<li><p><strong>execution_options</strong> (<em>SimulationExecutionOptions</em>) – </p></li>
</ul>
</dd>
</dl>
<p>Returns:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.kspaceFirstOrder2D.kspaceFirstOrder2DC">
<span class="sig-prename descclassname"><span class="pre">kwave.kspaceFirstOrder2D.</span></span><span class="sig-name descname"><span class="pre">kspaceFirstOrder2DC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kgrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">medium</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simulation_options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">execution_options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/kspaceFirstOrder2D.html#kspaceFirstOrder2DC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.kspaceFirstOrder2D.kspaceFirstOrder2DC" title="Permalink to this definition">#</a></dt>
<dd><p>2D time-domain simulation of wave propagation using C++ code.</p>
<p>kspaceFirstOrder2DC provides a blind interface to the C++ version of
kspaceFirstOrder2D (called kspaceFirstOrder-OMP) in the same way as
kspaceFirstOrder3DC. Note, the C++ code does not support all input
options, and all display options are ignored (only command line
outputs are given). See the k-Wave user manual for more information.
The function works by appending the optional input ‘save_to_disk’ to
the user inputs and then calling kspaceFirstOrder2D to save the input
files to disk. The contents of sensor.record (if set) are parsed as
input flags, and the C++ code is run using the system command. The
output files are then automatically loaded from disk and returned in
the same fashion as kspaceFirstOrder2D. The input and output files
are saved to the temporary directory native to the operating system,
and are deleted after the function runs.
For small simulations, running the simulation on a smaller number of
cores can improve performance as the matrices are often small enough
to fit within cache. It is recommended to adjust the value of
‘NumThreads’ to optimise performance for a given simulation size and
computer hardware. By default, simulations smaller than 128^2 are
set to run using a single thread (this behaviour can be over-ridden
using the ‘NumThreads’ option). In some circumstances, for very small
simulations, the C++ code can be slower than the MATLAB code.
This function requires the C++ binary/executable of
kspaceFirstOrder-OMP to be downloaded from
<a class="reference external" href="http://www.k-wave.org/download.php">http://www.k-wave.org/download.php</a> and placed in the “binaries”
directory of the k-Wave toolbox (the same binary is used for
simulations in 2D, 3D, and axisymmetric coordinates). Alternatively,
the name and location of the binary can be  specified using the
optional input parameters ‘BinaryName’ and ‘BinariesPath’.</p>
<p>This function is essentially a wrapper and directly uses the capabilities
of kspaceFirstOrder3DC by replacing the binary name with the name of the
GPU binary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kgrid</strong> (<a class="reference internal" href="kwave.kgrid.html#kwave.kgrid.kWaveGrid" title="kwave.kgrid.kWaveGrid"><em>kWaveGrid</em></a>) – kWaveGrid instance</p></li>
<li><p><strong>source</strong> (<a class="reference internal" href="kwave.ksource.html#kwave.ksource.kSource" title="kwave.ksource.kSource"><em>kSource</em></a>) – kWaveSource instance</p></li>
<li><p><strong>sensor</strong> (<a class="reference internal" href="kwave.ktransducer.html#kwave.ktransducer.NotATransducer" title="kwave.ktransducer.NotATransducer"><em>NotATransducer</em></a><em> | </em><a class="reference internal" href="kwave.ksensor.html#kwave.ksensor.kSensor" title="kwave.ksensor.kSensor"><em>kSensor</em></a>) – NotATransducer or kSensor instance</p></li>
<li><p><strong>medium</strong> (<a class="reference internal" href="kwave.kmedium.html#kwave.kmedium.kWaveMedium" title="kwave.kmedium.kWaveMedium"><em>kWaveMedium</em></a>) – kWaveMedium instance</p></li>
<li><p><strong>simulation_options</strong> (<em>SimulationOptions</em>) – SimulationOptions instance</p></li>
<li><p><strong>execution_options</strong> (<em>SimulationExecutionOptions</em>) – SimulationExecutionOptions instance</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sensor data as a numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kwave.kspaceFirstOrder2D.kspace_first_order_2d_gpu">
<span class="sig-prename descclassname"><span class="pre">kwave.kspaceFirstOrder2D.</span></span><span class="sig-name descname"><span class="pre">kspace_first_order_2d_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kgrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">medium</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simulation_options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">execution_options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kwave/kspaceFirstOrder2D.html#kspace_first_order_2d_gpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kwave.kspaceFirstOrder2D.kspace_first_order_2d_gpu" title="Permalink to this definition">#</a></dt>
<dd><p>2D ime-domain simulation of wave propagation on a GPU using C++ CUDA code.</p>
<p>kspaceFirstOrder2DG provides a blind interface to the C++/CUDA
version of kspaceFirstOrder2D (called kspaceFirstOrder-CUDA) in the
same way as kspaceFirstOrder3DC. Note, the C++ code does not support
all input options, and all display options are ignored (only command
line outputs are given). See the k-Wave user manual for more
information.
The function works by appending the optional input ‘save_to_disk’ to
the user inputs and then calling kspaceFirstOrder2D to save the input
files to disk. The contents of sensor.record (if set) are parsed as
input flags, and the C++ code is run using the system command. The
output files are then automatically loaded from disk and returned in
the same fashion as kspaceFirstOrder2D. The input and output files
are saved to the temporary directory native to the operating system,
and are deleted after the function runs.
This function requires the C++ binary/executable of
kspaceFirstOrder-CUDA to be downloaded from
<a class="reference external" href="http://www.k-wave.org/download.php">http://www.k-wave.org/download.php</a> and placed in the “binaries”
directory of the k-Wave toolbox (the 2D and 3D code use the same
binary). Alternatively, the name and location of the binary can be
specified using the optional input parameters ‘BinaryName’ and
‘BinariesPath’.</p>
<p>This function is essentially a wrapper and directly uses the capabilities
of kspaceFirstOrder3DC by replacing the binary name with the name of the
GPU binary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kgrid</strong> (<a class="reference internal" href="kwave.kgrid.html#kwave.kgrid.kWaveGrid" title="kwave.kgrid.kWaveGrid"><em>kWaveGrid</em></a>) – </p></li>
<li><p><strong>source</strong> (<a class="reference internal" href="kwave.ksource.html#kwave.ksource.kSource" title="kwave.ksource.kSource"><em>kSource</em></a>) – </p></li>
<li><p><strong>sensor</strong> (<a class="reference internal" href="kwave.ktransducer.html#kwave.ktransducer.NotATransducer" title="kwave.ktransducer.NotATransducer"><em>NotATransducer</em></a>) – </p></li>
<li><p><strong>medium</strong> (<a class="reference internal" href="kwave.kmedium.html#kwave.kmedium.kWaveMedium" title="kwave.kmedium.kWaveMedium"><em>kWaveMedium</em></a>) – </p></li>
<li><p><strong>simulation_options</strong> (<em>SimulationOptions</em>) – </p></li>
<li><p><strong>execution_options</strong> (<em>SimulationExecutionOptions</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>ndarray</em></p>
</dd>
</dl>
</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="kwave.kspaceFirstOrder3D.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">kwave.kspaceFirstOrder3D module</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="kwave.kspaceFirstOrder.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">kwave.kspaceFirstOrder module</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, Walter Simson, Farid Yagubbayli
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">kwave.kspaceFirstOrder2D module</a><ul>
<li><a class="reference internal" href="#kwave.kspaceFirstOrder2D.kspaceFirstOrder2D"><code class="docutils literal notranslate"><span class="pre">kspaceFirstOrder2D()</span></code></a></li>
<li><a class="reference internal" href="#kwave.kspaceFirstOrder2D.kspaceFirstOrder2DC"><code class="docutils literal notranslate"><span class="pre">kspaceFirstOrder2DC()</span></code></a></li>
<li><a class="reference internal" href="#kwave.kspaceFirstOrder2D.kspace_first_order_2d_gpu"><code class="docutils literal notranslate"><span class="pre">kspace_first_order_2d_gpu()</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    </body>
</html>